<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.is.main.qnaBoard.QnaBoardDAO">
  	<sql id="searchSql">
  		WHERE QnaNum>0
  		
  		<choose>
  			<when test="kind=='name'">
  				AND QNANAME LIKE '%'||#{search}||'%'
  			</when>
  			<otherwise>
  				AND QNACONTENTS LIKE '%'||#{search}||'%'
  			</otherwise>
  		</choose>
  	</sql>
  
  	<select id="getTotal" parameterType="com.is.main.util.Pager" resultType="Long">
  		SELECT COUNT(QNANUM) FROM QNABOARD
  		<include refid="searchSql"></include>
  	</select>
  	
  	<select id="getList" parameterType="com.is.main.util.Pager" resultType="QnaBoardDTO" >
		SELECT QNANUM, QNANAME, QNASUBJECT, QNACONTENTS, QNADATE, QNAHIT, REF, STEP, DEPTH FROM	
			(SELECT ROWNUM R, Q.* FROM
				(
					SELECT * FROM QNABOARD
					<include refid="searchSql" />
						   
					ORDER BY QNANUM DESC
				) Q
			)
		WHERE R BETWEEN #{startRow} AND #{lastRow}
</select>
</mapper>